cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.99,0.99,1),2))
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,1,1,1),2))
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.99,0.99,1),2))
cor(mat)
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.9,0.9,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
cutoff <- c(0.81,0.99) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
#cutoff <- c(0.81,0.99) %>% qnorm()
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
#cutoff <- c(0.81,0.99) %>% qnorm()
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
#cutoff <- c(0.81,0.99) %>% qnorm()
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
#cutoff <- c(0.81,0.99) %>% qnorm()
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
#cutoff <- c(0.81,0.99) %>% qnorm()
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
#cutoff <- c(0.81,0.99) %>% qnorm()
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
mat <- MASS::mvrnorm(n = 1000, c(0,0),Sigma = matrix(c(1,0.3,0.3,1),2))
#cutoff <- c(0.81,0.99) %>% qnorm()
cutoff <- c(0.25,0.75) %>% qnorm()
index1 <- mat > cutoff[2]
index2 <- mat < cutoff[2] & mat > cutoff[1]
index3 <- mat < cutoff[1]
mat[index1] <- 1
mat[index2] <- 0
mat[index3] <- -1
cor(mat)
outer(c(1,0.3),c(1,0.3),`*`)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
sigma_gen <- matrix(rep(0.1, 2**2), 2)
sigma_gen <- matrix(rep(0.1, 4**4), 4)
sigma_gen <- matrix(rep(0.1, 4**2), 4)
sigma_gen_poly <-matrix(rep(1:4,each = 4), 4) - matrix(rep(1:4, 4), 4)
View(sigma_gen_poly)
sigma_gen ** sigma_gen_poly
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
test2 <- simPopLD_l2_sp(1000, 50, 0.5, 0.05, 2, 2, 1,0)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test2 <- simPopLD_l2_sp(1000, 50, 0.5, 0.05, 2, 2, 1,0)
cor_dat <- cor(test2)
cor_dat <- cor(test2[,1:50])
View(cor_dat)
test2 <- simPopLD_l2_sp(1000, 50, 0.5, 0.05, 1, 2, 1,0)
cor_dat <- cor(test2[,1:50])
View(cor_dat)
test2 <- simPopLD_l2_sp(1000, 50, 0.5, 0.05, 1, 2, 1,0.1)
cor_dat <- cor(test2[,1:50])
View(cor_dat)
test2 <- simPopLD_l2_sp(1000, 50, 0.5, 0.05, 1, 2, 1,0.5)
View(cor_dat)
cor_dat <- cor(test2[,1:50])
sqrt(0.6)
test2 <- simPopLD_l2_sp(1000, 50, 0.5, 0.05, 1, 2, 1,0.77)
cor_dat <- cor(test2[,1:50])
View(cor_dat)
r <- fanc(cor_dat, n.obs = 2000, factors = 1)
r$nonzero.loadings
r$BIC_dfnonzero
r$loadings$gamma9$rho19
View(cor_dat)
test2 <- simPopLD_l2_sp(1000, 50, 0.5, 0.05, 1, 2, 1,0.1)
cor_dat <- cor(test2)
cor_dat <- cor(test2[1:50])
cor_dat <- cor(test2[,1:50])
View(cor_dat)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
rep(1/1,1)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, NULL,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(num_strata = 1, MAF_strata = 0.1, P_strata = 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(num_strata = 1, MAF_strata = 0.1, p_strata = 0.05,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(num_strata = 1, MAF_strata = 0.1, P_strata = 0.05,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(num_strata = 1, MAF_strata = 0.1, 0.05,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(num_strata = 1, 0.1, 0.05,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05,1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05,1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, 0.5,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, 0.5,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, 0.5,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, 0.5,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1, 0.1, 0.05, 0.5,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1, 0.1, 0.05, 1,N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
object <- as.list(substitute(list(...)))[-1L]
object
mrn <- is.null(row.names)
mrn
row.names()
row.names
x <- list(...)
test3 <- sib_sim(1, 0.1, 0.05, 1, N = 1000, num_SNP = 50, MAF = 0.1, main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
sib_sim()
sib_sim(1)
sib_sim(1,0.05,)
sib_sim(1,0.1,0.05)
sib_sim(1,0.1,0.05,1)
sib_sim(1,0.1,0.05,1,N = 1000)
sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50)
sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, main_effect = 1.5, interaction_effect = 2)
sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2)
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
juzi()
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2)
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05)
MAF
p
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
a <- function(...) {
b <- list(...)
print(b)
}
a(x = 1, y = 2)
a(x = 1, y = 2, MAF = 1)
a(x = 1, y = 2, MAF = 1,p=1)
test3 <- sib_sim(num_strata  = 1,
MAF_strata = 0.1,
P_strata = 0.05,
proportion_strata = 1,
N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
test3 <- sib_sim(1,0.1,0.05,1,list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
test3 <- sib_sim(2,c(0.1, 0.5),c(0.01,0.09) ,c(0.5,0.5),list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
table(test3$SNP1)/2000
table(test3$SNP3)/2000
table(test3$SNP4)/2000
simVal(test3)
clogit(Y ~ SNP1*SNP2+strata(fid), data = test3) %>% summary()
clogit(Y ~ SNP3+strata(fid), data = test3) %>% summary()
clogit(Y ~ SNP4+strata(fid), data = test3) %>% summary()
clogit(Y ~ SNP3*SNP4+strata(fid), data = test3) %>% summary()
test3 <- sib_sim(2,c(0.1, 0.5),c(0.01,0.09) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 1, p = 0.05))
clogit(Y ~ SNP3*SNP4+strata(fid), data = test3) %>% summary()
clogit(Y ~ SNP1*SNP2+strata(fid), data = test3) %>% summary()
lm(SNP1 ~ SNP2, data = test3)
lm(SNP1 ~ SNP2, data = test3) %>% summary()
test3 <- sib_sim(2,c(0.1, 0.5),c(0.01,0.09) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 1, p = 0.05))
lm(SNP1 ~ SNP2, data = test3) %>% summary()
clogit(Y ~ SNP1*SNP2+strata(fid), data = test3) %>% summary()
cor_test3 <- cor(test3)
cor_test3 <- cor(test3[1:50])
View(cor_test3)
plyr::aaply(test3, 2, sd)
plyr::aaply(test3, 1, sd)
plyr::aaply(test3[1:50], 1, sd)
plyr::aaply(test3[,1:50], 1, sd)
plyr::aaply(test3[,1:50], 2, sd)
plyr::aaply(test3[,1:50], 2, class)
test[1:10,1:2]
test3[1:10,1:2]
cor_case_test3 <- cor(test[Y == 1, 1:50])
cor_case_test3 <- cor(test3[Y == 1, 1:50])
View(cor_case_test3)
cor_case_test3 <- cor(test3[Y == 0, 1:50])
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
View(cor_control_test3)
View(cor_control_test3)
test3 <- sib_sim(2,c(0.1, 0.5),c(0.01,0.09) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/simulate data LE.R')
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
View(cor_case_test3)
View(cor_case_test3)
test3 <- sib_sim(2,c(0.5, 0.5),c(0.01,0.09) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
test3 <- sib_sim(2,c(0.5, 0.5),c(0.05,0.05) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
test3 <- sib_sim(2,c(0.5, 0.5),c(0.01,0.1) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
test3 <- sib_sim(2,c(0.5, 0.4),c(0.01,0.1) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
View(cor_control_test3)
View(cor_case_test3)
View(cor_control_test3)
test3 <- sib_sim(2,c(0.5, 0.25),c(0.01,0.09) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
test3 <- sib_sim(2,c(0.5, 0.25),c(0.05,0.05) ,c(0.5,0.5),
list(N = 1000,num_SNP = 50, MAF = 0.1,main_effect = 1.5, interaction_effect = 2, p = 0.05))
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_control_test3 <- cor(test3[Y == 0, 1:50])
View(cor_case_test3)
cov_test3<- partial(test3[Y == 1, 1:50], test3[Y == 0, 1:50])
View(cor_test3)
cor_case_test3 <- cor(test3[Y == 1, 1:50])
cor_test3<- partial(test3[Y == 1, 1:50], test3[Y == 0, 1:50])
View(cor_test3)
r <- fanc(covmat = cor_test3, n.obs = 500,factors = 1)
r$nonzero.loadings
r$loadings$gamma9$rho20
r$BIC_dfnonzero
r <- fanc(covmat = cor_test3, n.obs = 1000,factors = 1)
r$nonzero.loadings
r$BIC_dfnonzero
r <- fanc(covmat = cor_test3, n.obs = 500,factors = 1)
r$BIC_dfnonzero
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
fisherz(0.28)
r2t(0.28)
r2t(0.28, 1000)
fisherz(0.09)
fisherz(0.10)
fisherz(0.33)
fisherz(1)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
partial <- function(case, control){
cormat_case <- cor(case) %>% fisherz()
cormat_control <- cor(control) %>% fisherz()
cor_cc <- cormat_case - cormat_control + diag(ncol(case))
return(cor_cc)
}
partial(test3[Y == 1, 1:10], test3[Y == 0, 1:10])
fisherz(0.434)
fisherz(0.434) - fisherz(0.153)
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
source('C:/Users/doublex/Desktop/fsdata/episfa/Simulation/functions.R')
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4)) %>% as.list()
a
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4),x3 = list(c(1,2),c(2,3))) %>% as.list()
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4))) %>% as.list(x3 = list(c(1,2),c(2,3))
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4)) %>% as.list(x3 = list(c(1,2),c(2,3))
ï¼‰
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4)) %>% as.list(x3 = list(c(1,2),c(2,3)))
a
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4)) %>% as.list() %>% c(x3 = list(c(1,2),c(2,3)))
a
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4)) %>% as.list() %>% list(x3 = list(c(1,2),c(2,3)))
a
a <- data.frame(x1 = c(1,2,3),x2 = c(2,3,4)) %>% as.list() %>% c(x3 = list(c(1,2),c(2,3)))
a
a <- data.frame(x1 = c(1,2,3)) %>% as.list() %>% c(x3 = list(c(1,2),c(2,3)))
a
a <- data.frame(x1 = c(1,2,3)) %>% as.list() %>% list(x3 = list(c(1,2),c(2,3)))
a
a <- data.frame(x1 = c(1,2,3)) %>% as.list() %>% list(x3 = list(c(1,2),c(2,3))) %>% setNames("x1","x3")
a <- data.frame(x1 = c(1,2,3)) %>% as.list() %>% list(x3 = list(c(1,2),c(2,3))) %>% setNames("x1","x3")
